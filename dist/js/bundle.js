!function e(t,o,a){function n(i,c){if(!o[i]){if(!t[i]){var l="function"==typeof require&&require;if(!c&&l)return l(i,!0);if(r)return r(i,!0);var s=new Error("Cannot find module '"+i+"'");throw s.code="MODULE_NOT_FOUND",s}var p=o[i]={exports:{}};t[i][0].call(p.exports,function(e){var o=t[i][1][e];return n(o?o:e)},p,p.exports,e,t,o,a)}return o[i].exports}for(var r="function"==typeof require&&require,i=0;i<a.length;i++)n(a[i]);return n}({1:[function(e,t,o){t.exports={populateFilterOptions:function(e,t){$("#select-filter-tag").append("<option value='None' selected='selected'>No Tag Filter</option>");for(var o,a=0,n=e.length;n>a;a++)o=document.createElement("option"),o.setAttribute("value",e[a]),o.innerHTML=e[a],t.appendChild(o)},clear:function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},displayError:function(e){var t=document.createElement("p");t.setAttribute("class","errorMessage"),t.innerHTML=e,error.appendChild(t)},toggleSearchBar:function(){$(".inputBox").toggle(300),"Search City"===$("#toggle-search").text()?($("#toggle-search").text("Search Hide"),$("#location-input").focus()):$("#toggle-search").text("Search City")},closeSearchBarOnSelectPhoto:function(){window.location.href=window.location.pathname+"#",$(".inputBox").hide(300),"Search Hide"===$("#toggle-search").text()&&$("#toggle-search").text("Search City")},bindClickEventOnPhoto:function(e,t){document.getElementById(e).addEventListener("click",function(e){return function(){google.maps.event.trigger(e,"click")}}(t))}}},{}],2:[function(e,t,o){"use strict";function a(){n=new google.maps.LatLng(45.5015217,-73.5732091),r={zoom:15,center:n,mapTypeId:google.maps.MapTypeId.ROADMAP},i=new google.maps.Map(d,r),c=new google.maps.InfoWindow({}),b.fetchPhotos(45.5015217,-73.5732091),b.fetchWeatherInfo(45.5015217,-73.5732091)}var n,r,i,c,l,s,p,g,u=e("./helpers"),d=document.getElementById("map-canvas"),h=(document.getElementById("instagram"),document.getElementById("error")),m=document.getElementById("select-filter-tag"),f=new google.maps.places.SearchBox(document.getElementById("location-input"));google.maps.event.addListener(f,"places_changed",function(){u.clear(h),$("#toggle-search").trigger("click"),l=f.getPlaces(),l[0]?(s=l[0].geometry.location.G,p=l[0].geometry.location.K,i=new google.maps.Map(d,{zoom:15,center:new google.maps.LatLng(s,p),mapTypeId:google.maps.MapTypeId.ROADMAP}),c=new google.maps.InfoWindow,b.fetchPhotos(s,p),b.fetchWeatherInfo(s,p)):u.displayError("No such place, try again."),$("#location-input").val("")});var v=function(e,t,o){var a=this;a.photoId=ko.observable(e),a.imgURL=ko.observable(o.images.thumbnail.url),a.caption=ko.observable(t),a.lat=ko.observable(o.location.latitude),a.lon=ko.observable(o.location.longitude),a.tags=ko.observableArray(o.tags),a.username=ko.observable(o.user.username),a.marker=ko.observable(new google.maps.Marker({position:new google.maps.LatLng(a.lat(),a.lon()),map:i,icon:"/images/resized/camera.png"})),google.maps.event.addListener(a.marker(),"click",function(e){var t="<div class='infoWindow'><img src='"+a.imgURL()+"'><p>"+a.caption()+"</p><b>@"+a.username()+"</p></div>";return function(){c.setContent(t),c.open(i,e)}}(a.marker()))},b={city:ko.observable(""),humidity:ko.observable(""),temp:ko.observable(""),summary:ko.observable(""),iconURL:ko.observable(""),photos:ko.observableArray([]),filter:ko.observable(""),openInfoWindow:function(e){u.bindClickEventOnPhoto(e.photoId(),e.marker())},fetchPhotos:function(e,t){g="https://api.instagram.com/v1/media/search?lat="+e+"&lng="+t+"&access_token=322608956.c39a870.654d8fb14b8d48838cc430bebcb0dede",$.ajax({type:"GET",url:g,dataType:"jsonp",success:b.renderPhotos})},renderPhotos:function(e){b.filter(""),u.clear(m);var t=[];if(e.data){b.photos.removeAll();for(var o,a,n,r,i=0,c=e.data.length;c>i;i++){if(n="photo-"+i,a=b.hasTitle(e.data[i]),r=e.data[i].tags.length,r>0)for(var l=0;r>l;l++)t.push(e.data[i].tags[l]);o=new v(n,a,e.data[i]),b.photos.push(o)}var s=[];$.each(t,function(e,t){-1===$.inArray(t,s)&&s.push(t)}),u.populateFilterOptions(s,m),window.location.href=window.location.pathname+"#instagram"}else u.displayError("No photos found...")},hasTitle:function(e){return e.caption&&e.caption.text?e.caption.text:"No Title"},fetchWeatherInfo:function(e,t){var o="http://api.openweathermap.org/data/2.5/weather?lat="+e+"&lon="+t+"&units=metric";$.ajax({type:"GET",url:o,success:b.renderWeather,dataType:"jsonp"})},renderWeather:function(e){if(e.main){var t=e.name,o=e.main.humidity+"%",a=e.main.temp+"â„ƒ",n=e.weather[0].description,r="http://openweathermap.org/img/w/"+e.weather[0].icon+".png";b.city(t),b.humidity(o),b.temp(a),b.summary(n),b.iconURL(r)}else u.displayError("No weather found for this city...")}};b.filteredPhotos=ko.computed(function(){if(!b.filter())return b.photos();var e=b.filter();return e&&"None"!=e?ko.utils.arrayFilter(b.photos(),function(t){return t.tags.indexOf(e)>-1?(t.marker().setMap(i),!0):void t.marker().setMap(null)}):(b.photos().forEach(function(e){e.marker().setMap(i)}),b.photos())}),ko.applyBindings(b),google.maps.event.addDomListener(window,"load",a),$("#toggle-search").click(function(){u.toggleSearchBar(),$("#main").css("background-color","rgba(100, 100, 100, 0.5)")}),$("#photo-list").click(function(){u.closeSearchBarOnSelectPhoto()}),$("#select-filter-tag").change(function(){var e=$(this).val();b.filter(e)})},{"./helpers":1}]},{},[2]);
